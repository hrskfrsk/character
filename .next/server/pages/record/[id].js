"use strict";(()=>{var e={};e.id=459,e.ids=[459],e.modules={6643:(e,t,r)=>{r.r(t),r.d(t,{config:()=>A,default:()=>S,getServerSideProps:()=>v,getStaticPaths:()=>j,getStaticProps:()=>w,reportWebVitals:()=>k,routeModule:()=>I,unstable_getServerProps:()=>E,unstable_getServerSideProps:()=>R,unstable_getStaticParams:()=>C,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>B});var n={};r.r(n),r.d(n,{default:()=>b,getServerSideProps:()=>y});var i=r(7093),a=r(5244),o=r(1323),s=r(7645),l=r(6814),c=r(997),d=r(968),p=r.n(d),u=r(1163),x=r(6689),f=r(2149),h=r(3320),g=r(7822),m=r(5696);function b({recordSection:e,characterName:t,sectionTitle:r,characterId:n}){let i=(0,u.useRouter)(),[a,o]=(0,x.useState)({}),[s,l]=(0,x.useState)({}),[d,f]=(0,x.useState)({}),b=e=>{o(t=>({...t,[e]:!t[e]}))},y=(e,t)=>{(s[e]||"")===t.password?(f(t=>({...t,[e]:!0})),l(t=>({...t,[e]:""}))):alert("パスワードが正しくありません")};if(!e)return(0,c.jsxs)("div",{children:[c.jsx(p(),{children:c.jsx("title",{children:"記録が見つかりません"})}),(0,c.jsxs)("div",{style:{padding:"20px",textAlign:"center"},children:[c.jsx("h1",{children:"記録が見つかりません"}),c.jsx("p",{children:"指定された記録は存在しません。"}),c.jsx("button",{onClick:()=>i.back(),style:{padding:"10px 20px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"戻る"})]})]});let S=`${r} - ${t} - CoC6版キャラクターシート`;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(p(),{children:[c.jsx("title",{children:S}),c.jsx("meta",{name:"description",content:`${t}の${r}`}),c.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),c.jsx(g.Z,{showBackButton:!1,showCreateButton:!1,showEditButton:!0,editUrl:`/create?edit=${n}`}),c.jsx("div",{children:(0,c.jsxs)("div",{style:{maxWidth:"800px",margin:"3% auto 0",backgroundColor:"white",borderRadius:"8px",padding:"30px 30px 40px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[(0,c.jsxs)("div",{style:{marginBottom:"0",borderBottom:"2px solid #eee",paddingBottom:"20px"},children:[(0,c.jsxs)("h1",{style:{fontSize:"24px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"15px"},children:[c.jsx("i",{className:"fas fa-clipboard"}),r]}),c.jsx("p",{style:{color:"#666",fontSize:"14px",margin:0},children:(0,c.jsxs)("a",{href:`/character/${n}`,style:{color:"#74cdc3",textDecoration:"none",display:"flex",alignItems:"center",gap:"5px"},onMouseEnter:e=>{e.currentTarget.style.color="#5fb5aa",e.currentTarget.style.textDecoration="underline"},onMouseLeave:e=>{e.currentTarget.style.color="#74cdc3",e.currentTarget.style.textDecoration="none"},children:[c.jsx("i",{className:"fas fa-arrow-circle-left"}),t,"のシートに戻る"]})})]}),c.jsx("div",{className:"record-content",children:e.fields.map(e=>{let t=!0===e.open_by_default,r=void 0!==a[e.id]?a[e.id]:t,n=e.password_protected,i=d[e.id]||!1;return(0,c.jsxs)("div",{style:{marginBottom:"0"},children:[e.title&&(0,c.jsxs)("h2",{onClick:()=>b(e.id),style:{fontSize:"0.9rem",fontWeight:"normal",marginBottom:"0",padding:"5px",cursor:"pointer",display:"flex",alignItems:"center",userSelect:"none",borderBottom:"dotted 1px #000"},children:[c.jsx("i",{className:`fas ${r?"fa-chevron-down":"fa-chevron-right"}`,style:{fontSize:"12px",marginRight:"8px"}}),n&&c.jsx("i",{className:"fas fa-lock",style:{fontSize:"10px",marginRight:"5px",opacity:.7}}),c.jsx("span",{children:e.title})]}),r&&c.jsx("div",{style:{lineHeight:"1.8",color:"#444",fontSize:"0.9rem",whiteSpace:"pre-wrap",padding:"10px 10px 30px"},children:n&&!i?(0,c.jsxs)("div",{style:{textAlign:"center",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #e0e0e0"},children:[c.jsx("i",{className:"fas fa-lock",style:{fontSize:"24px",color:"#ccc",marginBottom:"10px",display:"block"}}),c.jsx("p",{style:{marginBottom:"15px",color:"#666",fontSize:"0.8rem"},children:"この項目はパスワードで保護されています"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center",alignItems:"center",maxWidth:"250px",margin:"0 auto"},children:[c.jsx("input",{type:"password",placeholder:"パスワード",value:s[e.id]||"",onChange:t=>l(r=>({...r,[e.id]:t.target.value})),onKeyDown:t=>{"Enter"===t.key&&y(e.id,e)},style:{flex:1,padding:"6px 8px",border:"1px solid #ddd",borderRadius:"3px",fontSize:"0.8rem"}}),c.jsx("button",{onClick:()=>y(e.id,e),style:{padding:"6px 12px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"bold"},children:"解除"})]})]}):(0,h.Bc)(e.content)})]},e.id)})})]})}),c.jsx(m.Z,{})]})}let y=async({params:e})=>{if(!e?.id||"string"!=typeof e.id)return{notFound:!0};try{let t=e.id,r=await (0,f.pm)(),n=null,i="",a="",o="";for(let e of r)if(e.record_sections){let r=e.record_sections.find(e=>e.id===t);if(r){n=r,i=e.character_name||"キャラクター",a=r.section_title||"無題の記録",o=e.id;break}}if(!n)return{notFound:!0};return{props:{recordSection:n,characterName:i,sectionTitle:a,characterId:o}}}catch(e){return console.error("getServerSideProps error:",e),{notFound:!0}}},S=(0,o.l)(n,"default"),w=(0,o.l)(n,"getStaticProps"),j=(0,o.l)(n,"getStaticPaths"),v=(0,o.l)(n,"getServerSideProps"),A=(0,o.l)(n,"config"),k=(0,o.l)(n,"reportWebVitals"),B=(0,o.l)(n,"unstable_getStaticProps"),P=(0,o.l)(n,"unstable_getStaticPaths"),C=(0,o.l)(n,"unstable_getStaticParams"),E=(0,o.l)(n,"unstable_getServerProps"),R=(0,o.l)(n,"unstable_getServerSideProps"),I=new i.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/record/[id]",pathname:"/record/[id]",bundlePath:"",filename:""},components:{App:l.default,Document:s.default},userland:n})},2149:(e,t,r)=>{r.d(t,{pm:()=>c,_m:()=>l,nd:()=>s});let n=require("firebase-admin/app"),i=require("firebase-admin/firestore"),a=null,o=!1;async function s(e){try{if(!o||!a)return console.warn("Firebase Admin not initialized, cannot fetch character data"),null;let t=await a.collection("characters").doc(e).get();if(!t.exists)return null;let r=t.data(),n=JSON.parse(JSON.stringify(r,(e,t)=>t&&"object"==typeof t&&t._seconds?new Date(1e3*t._seconds).toISOString():t));return{id:t.id,...n}}catch(e){return console.error("Character data fetch error:",e),null}}async function l(){try{if(!o||!a)return console.warn("Firebase Admin not initialized, cannot fetch character IDs"),[];return(await a.collection("characters").get()).docs.map(e=>({params:{id:e.id}}))}catch(e){return console.error("Character IDs fetch error:",e),[]}}async function c(){try{if(!o||!a)return console.warn("Firebase Admin not initialized, cannot fetch character data"),[];return(await a.collection("characters").get()).docs.map(e=>{let t=e.data(),r=JSON.parse(JSON.stringify(t,(e,t)=>t&&"object"==typeof t&&t._seconds?new Date(1e3*t._seconds).toISOString():t));return{id:e.id,...r}})}catch(e){return console.error("All character data fetch error:",e),[]}}!function(){try{if(!(0,n.getApps)().length){let e="-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDW4B7UQap7LamG\nSHRODkRUvpfFki/WyfufzTeaWePVhoPFpBKvyV/oHu4l6GDinbGfsIIcLAw09c0A\njsC/Zd/MJikwZz1zDdH6fs+ax2xpz2mA3biwxKx79l7d9k4fLLW5kfrjI1J/auFU\nPQYcvmwGLk/iAayRaJfesphyMauRGn2QC9yHpiVaxFVHW6mq6Wed1RdFYGmZvyoa\nkx5M/YOVIMwfulx+8z4ApIzisPK4RtjtjQR6M8Ntwl+hyyvruKUZb+jPnkCozKGV\ndfSPTjMpJfA8oZdRhKbiIDpS+aiWVKjEmCBgSdEwV06VFsFyKmpU7kDvZFpGoMEF\nvixYPCBZAgMBAAECggEAAUR3czrH7cvKTHwwWks6rasA/i2iSOQOZehWjQ2rQYN2\nd4TWPRhZj53PFvK5YdzRZ7AE2QZDxnQybjj7oFxAC7GoN2W7W1hhPPuXpnik8+v3\n2esHLUqbsdnHm8Jr4vl5ZYKJf3TrT17Pc7t3RgyzyCIfg6V64a1DaBEpnsCIQIqQ\naEd22UAQkwg8TIufKfy705BUDXV/3gVQ/n5CcGyahXTF86peNMCHxKCaQ19YhybW\neTHFJErybqhta0roYOSxfeGWIZipxFaEO4LG0RGo4hbPLDyEu0J/X1uRCmtUvJKh\n++GP9xkvFD0IzAXXrrV9bUcvJXvFNtPtb8PgvEpL4QKBgQDva2X8hnP/OEu0Ti5i\n2mMcbw5UG3aaqhFeq3fuYAY+X7M31kil1pv02UzTbvbi3E7lhWZRp4cQg+TDRyBX\no2WT3PNj7OtgU5giDLz9UCZ5CUMuhQoRn4w9dfMsCKxlwZlA6VWjUQtKmAIOBUTv\nmFe0aVESldPd3iuLL0/KJ635BQKBgQDlwZZerhiIXVi3iinfw+pRzBiQySVJrBqs\nuBFMa/3ViSWxg1HSfIY+W+L104lP3GN7DGmlKIRLrYGapcGQHBi5oWCydWCdEXg8\nWMCBqSzeDSslHceyftOqOlwYI3T8gkasY2mRPuu5TqfRjYEIi6j+or4C9Q4JilO8\nAFJtbk+aRQKBgQCkutx9F3WQUQelk3VPBrvSwIa3T/4XBJTW8lueY+tn1yjUblel\n4zeDDFBT2bF8/eA7A8IWxJGlx1oLElEqe35Ucl30jvqUWHAAXYtbL16JQNo8k8UN\nwx0W3KTn0z/q832ir+kAaa6/MD+Zrf50a/lMZHons3cG3OpQ5cicaxjEkQKBgQCS\nPR/q78EputCnMkfo55iTq+bO8VjMhcEMwrQwAmS0r/DQBhfkc+I2euIBOj2iGVMw\nlPwBZcKfMLbXqj2D7n5GWVNlA5UVJHN1ZcBSR04JoDQgEc5z7InpRfAsZRUnS/yT\n6UreakA72La0iO7ic5KDUS7ETxo6NFOLzGCqypXcSQKBgQDIj34Fw9Mp5glx/uIb\nIr+TUO2GgBSaFUR2pN7SzN73ivWnb7tcXth7wAOoy61Pq6LRdqFFKowtqCuN8uCg\n+L8DwCz5ofLJu8uCEL/cmec57T8A/dS744hVxRXRgzsa2ury9s2JapHopjSdJr83\nkwbUswcywPgXXh3BfbNtnVsoRw==\n-----END PRIVATE KEY-----\n".replace(/\\n/g,"\n");if(!e)return console.warn("Firebase Admin environment variables are missing - running in offline mode"),!1;(0,n.initializeApp)({credential:(0,n.cert)({projectId:"hatake-ffb62",clientEmail:"firebase-adminsdk-fbsvc@hatake-ffb62.iam.gserviceaccount.com",privateKey:e}),projectId:"hatake-ffb62"}),console.log("Firebase Admin initialized successfully")}a=(0,i.getFirestore)(),o=!0}catch(e){return console.error("Firebase Admin initialization error:",e),o=!1,!1}}()},3320:(e,t,r)=>{r.d(t,{Bc:()=>o,_R:()=>s});var n=r(6689),i=r.n(n);let a=e=>{e.style.height="auto",e.style.height=`${e.scrollHeight}px`},o=e=>{let t;if(!e)return e;let r=[],n=0,a=/\[([^\]]+)\]\(([^)]+)\)/g,o=/(https?:\/\/[^\s]+|www\.[^\s]+)/g,s=[];for(;null!==(t=a.exec(e));){let[a,o,l]=t,c=t.index,d=c+a.length;c>n&&r.push(e.substring(n,c));let p=l.trim();p.startsWith("www.")&&(p=`https://${p}`),r.push(i().createElement("a",{key:`markdown-${c}`,href:p,target:"_blank",rel:"noopener noreferrer"},o)),s.push({start:c,end:d}),n=d}n<e.length&&r.push(e.substring(n));let l=[];return r.forEach((e,t)=>{"string"==typeof e?e.split(o).forEach((e,r)=>{if(o.test(e)){let n=e;e.startsWith("www.")&&(n=`https://${e}`),l.push(i().createElement("a",{key:`url-${t}-${r}`,href:n,target:"_blank",rel:"noopener noreferrer"},e))}else e&&l.push(e)}):l.push(e)}),l},s=({value:e,onChange:t,placeholder:r,id:n,minRows:o=3,maxRows:s=10})=>{let l=i().useRef(null);return i().useEffect(()=>{l.current&&a(l.current)},[e]),i().createElement("textarea",{ref:l,id:n,value:e,onChange:e=>{t(e.target.value),a(e.target)},placeholder:r,className:"auto-resize-textarea",style:{minHeight:`${20*o}px`,maxHeight:`${20*s}px`,overflowY:e.split("\n").length>s?"auto":"hidden"}})}},4324:e=>{e.exports=require("firebase/app")},4610:e=>{e.exports=require("firebase/auth")},6058:e=>{e.exports=require("firebase/firestore")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[859,342,664,280],()=>r(6643));module.exports=n})();